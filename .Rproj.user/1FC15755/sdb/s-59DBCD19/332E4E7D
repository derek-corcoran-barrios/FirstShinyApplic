{
    "contents" : "---\ntitle: \"Untitled\"\nauthor: \"Derek Corcoran\"\ndate: \"Wednesday, July 22, 2015\"\noutput: html_document\n---\n\n```{r, message=FALSE, warning=FALSE, echo=FALSE,results='hide'}\n#first load libraries\nlibrary(raster)\nlibrary(rasterVis)\nlibrary(maps)\nlibrary(maptools)\nlibrary(rgdal)\nlibrary(latticeExtra)\nlibrary(dplyr)\nlibrary(knitr)\nlibrary(unmarked)\nlibrary(lubridate)\nlibrary(glmulti)\nlibrary(gdistance)\nlibrary(spatstat)\nlibrary(plotKML)\nlibrary(stringi)\n```\nLoad topography and roads and rasterize roads\n\n```{r,echo=FALSE, cache=TRUE, warning=FALSE,message=FALSE}\nPNF<- readGDAL(\"PNF.asc\")\nPNF<-raster (PNF)\ntopo <- readGDAL(\"topomap.asc\")\ntopo<-raster (topo)\ntopo<-resample(topo,PNF)\n```\n\n```{r,echo=FALSE, cache=TRUE, warning=FALSE,message=FALSE}\nroads.v <- readOGR(dsn=\"C:/Users/usuario/Bats_California/layers\",layer=\"Roads\")\nroads.v <- spTransform(roads.v, CRS(\"+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs\"))\n```\n\n\n```{r,echo=FALSE, cache=TRUE, message=FALSE, warning=FALSE}\n#res 0.0006\narterial<-roads.v[roads.v$FUNCTIONAL==\"A - ARTERIAL\",]#22.352\ntemplate <- PNF  # this will be the template\ntemplate[] <- NA  # assigns all values as NA\narterial.r <- rasterize(arterial, template, field=22.352)\ntr1 <- transition(arterial.r, transitionFunction=mean, directions=8)\ntr1<-geoCorrection(tr1, scl=FALSE)\n\ncollector<-roads.v[roads.v$FUNCTIONAL==\"C - COLLECTOR\",]#17.8816\ntemplate <- PNF  # this will be the template\ntemplate[] <- NA  # assigns all values as NA\ncollector.r <- rasterize(collector, template, field=17.8816)\ntr2 <- transition(collector.r, transitionFunction=mean, directions=8)\ntr2<-geoCorrection(tr2, scl=FALSE)\n\nlocal<-roads.v[roads.v$FUNCTIONAL==\"L - LOCAL\",]#13.4112\ntemplate <- PNF  # this will be the template\ntemplate[] <- NA  # assigns all values as NA\nlocal.r <- rasterize(local, template, field=13.4112)\ntr3 <- transition(local.r, transitionFunction=mean, directions=8)\ntr3<-geoCorrection(tr3, scl=FALSE)\n\nother<-roads.v[is.na(roads.v$FUNCTIONAL),]#22.352\ntemplate <- PNF  # this will be the template\ntemplate[] <- NA  # assigns all values as NA\nother.r <- rasterize(other, template, field=22.352)\ntr4 <- transition(other.r, transitionFunction=mean, directions=8)\ntr4<-geoCorrection(tr4, scl=FALSE)\n```\n\n\n```{r,echo=FALSE, cache=TRUE,warning=FALSE}\nheightDiff <- function(x){x[2] - x[1]}\nhd <- transition(topo,heightDiff,8,symm=FALSE)\nslope<-geoCorrection(hd, scl=FALSE)\n```\n\n\n```{r, echo=FALSE,cache=TRUE, warning=FALSE}\nadj <- adjacent(topo, cells=1:ncell(topo), pairs=TRUE, directions=8)\nspeed <- slope\nspeed[adj] <- exp(-3.5 * abs(slope[adj] + 0.05))\nx <- geoCorrection(speed, scl=FALSE)\n```\n\n```{r,echo=FALSE, cache=TRUE, warning=FALSE}\nspeed2<-x+tr1+tr2+tr3+tr4\n```\n\n```{r,cache=TRUE}\nsplit<-raster(speed2)\nplot(split)\nres(split)\nwriteRaster(split, filename=\"speed.asc\", format=\"ascii\")\n```\n\n\n```{r,echo=FALSE, cache=TRUE}\nC.house<-c(-120.978485, 40.051758)\nQuincy<-c(-120.947176, 39.936836)\nh1nfs6<-c(-120.71708839034, 39.90249278342)\nh3nfs3<-c(-120.53036175598, 39.70433390614)\n#h5fs10<-c(-120.73995287618, 40.26070306158)\n#h1fs2<-c(-121.31918651746,39.87962829758)\n#h2fs6<-c(-120.26360942118,39.86057455938)\n\nQuincyToh1nfs6<- shortestPath(speed2, Quincy, h1nfs6, output=\"SpatialLines\")\nh1nfs6Toh3nfs3<- shortestPath(speed2, h1nfs6, h3nfs3,output=\"SpatialLines\")\n#h1fs5Toh5fs10<- shortestPath(speed2, h1fs5, h5fs10, output=\"SpatialLines\")\n#H5FS7ToH2FS12<-shortestPath(speed2, h5fs7, h2fs12, output=\"SpatialLines\")\n```\n\n```{r,echo=FALSE, warning=TRUE}\nplot(topo)\nlines(roads.v)\nlines(QuincyToh1nfs6, col=\"red\", lwd=2)#1\nlines(h1nfs6Toh3nfs3, col=\"red\", lwd=2)#2\n#lines(h1fs5Toh5fs10, col=\"red\", lwd=2)#3\n#lines(H5FS7ToH2FS12, col=\"red\", lwd=2)#4\n\n\n#1\nproj4string(QuincyToh1nfs6) <- CRS(\"+proj=longlat +datum=WGS84\")\n# not yet ready for export to KML;\nparse_proj4(proj4string(QuincyToh1nfs6))\nQuincyToh1nfs6<- reproject(QuincyToh1nfs6)\n# ... now ready for exportspTransform(RoadToH1FS12, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0\"))\nkml(QuincyToh1nfs6, kml = FALSE)\n\n2\nproj4string(h1nfs6Toh3nfs3) <- CRS(\"+proj=longlat +datum=WGS84\")\n# not yet ready for export to KML;\nparse_proj4(proj4string(h1nfs6Toh3nfs3))\nQuincyToH5FS3<- reproject(h1nfs6Toh3nfs3)\n# ... now ready for exportspTransform(RoadToH1FS12, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0\"))\nkml(h1nfs6Toh3nfs3, kml = FALSE)\n\n\n3\n#proj4string(h1fs5Toh5fs10) <- CRS(\"+proj=longlat +datum=WGS84\")\n# not yet ready for export to KML;\n#parse_proj4(proj4string(h1fs5Toh5fs10))\n#h1fs5Toh5fs10<- reproject(h1fs5Toh5fs10)\n# ... now ready for exportspTransform(RoadToH1FS12, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0\"))\n#kml(h1fs5Toh5fs10, kml = FALSE)\n\n#4\n#proj4string(H5FS7ToH2FS12) <- CRS(\"+proj=longlat +datum=WGS84\")\n# not yet ready for export to KML;\n#parse_proj4(proj4string(H5FS7ToH2FS12))\n#H5FS7ToH2FS12<- reproject(H5FS7ToH2FS12)\n# ... now ready for exportspTransform(RoadToH1FS12, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0\"))\n#kml(H5FS7ToH2FS12, kml = FALSE)\n```\n",
    "created" : 1437620196045.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1817665486",
    "id" : "332E4E7D",
    "lastKnownWriteTime" : 1437620726,
    "path" : "~/Rshinyapp/FistShinyApp/luck.Rmd",
    "project_path" : "luck.Rmd",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}